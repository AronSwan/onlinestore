# æ¶æ„æ–‡æ¡£å’Œä»£ç æ³¨é‡Šè§„èŒƒ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°åç«¯ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ã€ä»£ç è§„èŒƒå’Œæ³¨é‡Šæ ‡å‡†ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å®¢æˆ·ç«¯å±‚                                â”‚
â”‚                    (Web/Mobile/API)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        APIç½‘å…³å±‚                                â”‚
â”‚              (Nginxåå‘ä»£ç† + è´Ÿè½½å‡è¡¡)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åº”ç”¨æœåŠ¡å±‚                                â”‚
â”‚          (NestJSåº”ç”¨é›†ç¾¤ + è¿›ç¨‹ç®¡ç†)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ä¸šåŠ¡é€»è¾‘å±‚                                â”‚
â”‚        (æ§åˆ¶å™¨ + æœåŠ¡ + å®ä½“ + ä¸­é—´ä»¶)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¼“å­˜å±‚    â”‚   æ¶ˆæ¯é˜Ÿåˆ—     â”‚   æ•°æ®åº“å±‚     â”‚    å¤–éƒ¨æœåŠ¡       â”‚
â”‚   (Redis)   â”‚  (Redpanda)   â”‚   (MySQL)     â”‚   (æ”¯ä»˜/çŸ­ä¿¡)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯´æ˜

#### æ ¸å¿ƒæ¡†æ¶
- **NestJS**: ä¼ä¸šçº§Node.jsæ¡†æ¶ï¼Œæä¾›å®Œæ•´çš„MVCæ¶æ„
- **TypeORM**: ç±»å‹å®‰å…¨çš„ORMï¼Œæ”¯æŒMySQLã€PostgreSQLç­‰
- **TypeScript**: å¼ºç±»å‹JavaScriptè¶…é›†ï¼Œæé«˜ä»£ç è´¨é‡

#### æ•°æ®å­˜å‚¨
- **TiDB**: åˆ†å¸ƒå¼å…³ç³»å‹æ•°æ®åº“ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- **MySQL**: å¼€å‘ç¯å¢ƒæ•°æ®åº“
- **Redis**: ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Redpanda**: é«˜æ€§èƒ½æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafkaå…¼å®¹ï¼‰

#### åŸºç¡€è®¾æ–½
- **Kubernetes**: å®¹å™¨ç¼–æ’å’Œåˆ†å¸ƒå¼éƒ¨ç½²
- **PM2**: è¿›ç¨‹ç®¡ç†å’Œç›‘æ§
- **Nginx**: åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡

## ğŸ“ é¡¹ç›®ç»“æ„

### ç›®å½•ç»“æ„è¯´æ˜
```
backend/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ auth/                     # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts    # è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ auth.service.ts       # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ guards/               # è®¤è¯å®ˆå«
â”‚   â”‚   â”œâ”€â”€ strategies/           # è®¤è¯ç­–ç•¥
â”‚   â”‚   â””â”€â”€ dto/                  # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ products/                # å•†å“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ products.controller.ts
â”‚   â”‚   â”œâ”€â”€ products.service.ts
â”‚   â”‚   â”œâ”€â”€ entities/             # å®ä½“å®šä¹‰
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”œâ”€â”€ orders/                   # è®¢å•æ¨¡å—
â”‚   â”œâ”€â”€ users/                    # ç”¨æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ common/                   # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ filters/              # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”‚   â”œâ”€â”€ interceptors/         # æ‹¦æˆªå™¨
â”‚   â”‚   â”œâ”€â”€ decorators/           # è£…é¥°å™¨
â”‚   â”‚   â””â”€â”€ pipes/                # ç®¡é“
â”‚   â”œâ”€â”€ config/                   # é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ database/                 # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ cache/                    # ç¼“å­˜æ¨¡å—
â”‚   â”œâ”€â”€ messaging/                # æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å—
â”‚   â””â”€â”€ main.ts                   # åº”ç”¨å…¥å£
â”œâ”€â”€ test/                         # æµ‹è¯•ä»£ç 
â”œâ”€â”€ dist/                         # ç¼–è¯‘è¾“å‡º
â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
```

### æ¨¡å—ä¾èµ–å…³ç³»
```
main.ts
  â””â”€â”€ AppModule
      â”œâ”€â”€ AuthModule
      â”œâ”€â”€ ProductsModule
      â”œâ”€â”€ OrdersModule
      â”œâ”€â”€ UsersModule
      â”œâ”€â”€ DatabaseModule
      â”œâ”€â”€ CacheModule
      â””â”€â”€ MessagingModule
```

## ğŸ’» ä»£ç æ³¨é‡Šè§„èŒƒ

### æ–‡ä»¶å¤´æ³¨é‡Š
```typescript
/**
 * @file å•†å“æœåŠ¡æ¨¡å—
 * @description æä¾›å•†å“ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ŒåŒ…æ‹¬CRUDæ“ä½œã€åº“å­˜ç®¡ç†ã€ç¼“å­˜ç­–ç•¥ç­‰
 * @author å¼€å‘å›¢é˜Ÿ
 * @version 1.0.0
 * @created 2025-09-30
 * @updated 2025-09-30
 */
```

### ç±»æ³¨é‡Š
```typescript
/**
 * å•†å“æœåŠ¡ç±»
 * 
 * è´Ÿè´£å¤„ç†å•†å“ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬ï¼š
 * - å•†å“ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥
 * - åº“å­˜ç®¡ç†å’ŒéªŒè¯
 * - ä»·æ ¼è®¡ç®—å’Œä¼˜æƒ å¤„ç†
 * - ç¼“å­˜ç­–ç•¥å®ç°
 * 
 * @example
 * ```typescript
 * const productService = new ProductsService();
 * const products = await productService.findAll({ page: 1, limit: 20 });
 * ```
 * 
 * @class ProductsService
 * @Injectable
 */
@Injectable()
export class ProductsService {
  // ç±»å®ç°
}
```

### æ–¹æ³•æ³¨é‡Š
```typescript
/**
 * æ ¹æ®IDè·å–å•†å“è¯¦æƒ…
 * 
 * è¯¥æ–¹æ³•ä¼šä¼˜å…ˆä»ç¼“å­˜ä¸­è·å–å•†å“ä¿¡æ¯ï¼Œå¦‚æœç¼“å­˜ä¸å­˜åœ¨åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œ
 * å¹¶å°†ç»“æœç¼“å­˜èµ·æ¥ä»¥æé«˜åç»­è®¿é—®æ€§èƒ½ã€‚
 * 
 * @param {number} id - å•†å“ID
 * @param {boolean} [useCache=true] - æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œé»˜è®¤ä¸ºtrue
 * 
 * @returns {Promise<Product>} å•†å“å®ä½“å¯¹è±¡
 * 
 * @throws {NotFoundException} å½“å•†å“ä¸å­˜åœ¨æ—¶æŠ›å‡º
 * @throws {DatabaseException} å½“æ•°æ®åº“æŸ¥è¯¢å¤±è´¥æ—¶æŠ›å‡º
 * 
 * @example
 * ```typescript
 * const product = await productsService.findById(1);
 * console.log(product.name); // è¾“å‡ºå•†å“åç§°
 * ```
 * 
 * @async
 */
async findById(id: number, useCache: boolean = true): Promise<Product> {
  // æ–¹æ³•å®ç°
}
```

### å±æ€§æ³¨é‡Š
```typescript
/**
 * å•†å“åº“å­˜æ•°é‡
 * 
 * è¯¥å±æ€§è¡¨ç¤ºå•†å“çš„å½“å‰åº“å­˜æ•°é‡ï¼Œå½“åº“å­˜ä¸º0æ—¶å•†å“å°†è‡ªåŠ¨ä¸‹æ¶ã€‚
 * åº“å­˜å˜æ›´æ—¶ä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶é€šçŸ¥ã€‚
 * 
 * @type {number}
 * @default 0
 * @min 0
 * @max 1000000
 */
@Column({ type: 'int', default: 0 })
stock: number;
```

### æ¥å£æ³¨é‡Š
```typescript
/**
 * å•†å“æŸ¥è¯¢å‚æ•°æ¥å£
 * 
 * å®šä¹‰å•†å“åˆ—è¡¨æŸ¥è¯¢æ—¶æ”¯æŒçš„å‚æ•°ç±»å‹å’Œçº¦æŸæ¡ä»¶ã€‚
 * 
 * @interface ProductQueryParams
 */
interface ProductQueryParams {
  /**
   * é¡µç ï¼Œä»1å¼€å§‹
   * @type {number}
   * @default 1
   * @minimum 1
   */
  page?: number;
  
  /**
   * æ¯é¡µæ•°é‡
   * @type {number}
   * @default 20
   * @minimum 1
   * @maximum 100
   */
  limit?: number;
  
  /**
   * åˆ†ç±»ç­›é€‰
   * @type {string}
   */
  category?: string;
}
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯¦è§£

### è®¤è¯æ¨¡å— (AuthModule)

#### åŠŸèƒ½èŒè´£
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- JWTä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯
- æƒé™æ§åˆ¶å’Œè§’è‰²ç®¡ç†
- ä¼šè¯ç®¡ç†å’Œå®‰å…¨é˜²æŠ¤

#### æ ¸å¿ƒç»„ä»¶
```typescript
/**
 * JWTè®¤è¯å®ˆå«
 * 
 * ä¿æŠ¤éœ€è¦è®¤è¯çš„æ¥å£ï¼ŒéªŒè¯JWTä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚
 * å¦‚æœä»¤ç‰Œæ— æ•ˆæˆ–è¿‡æœŸï¼Œå°†è¿”å›401é”™è¯¯ã€‚
 * 
 * @class JwtAuthGuard
 * @extends AuthGuard('jwt')
 */
@Injectable()
export class JwtAuthGuard extends AuthGuard('jwt') {
  // å®ç°ç»†èŠ‚
}
```

### å•†å“æ¨¡å— (ProductsModule)

#### åŠŸèƒ½èŒè´£
- å•†å“ä¿¡æ¯ç®¡ç†
- åº“å­˜è·Ÿè¸ªå’Œé¢„è­¦
- ä»·æ ¼ç­–ç•¥å’Œä¼˜æƒ 
- åˆ†ç±»å’Œæ ‡ç­¾ç®¡ç†

#### ç¼“å­˜ç­–ç•¥
```typescript
/**
 * å•†å“ç¼“å­˜é”®ç”Ÿæˆå™¨
 * 
 * ç»Ÿä¸€ç®¡ç†å•†å“ç›¸å…³çš„ç¼“å­˜é”®å‘½åè§„åˆ™ï¼Œç¡®ä¿é”®çš„å”¯ä¸€æ€§å’Œå¯è¯»æ€§ã€‚
 * 
 * @class ProductCacheKeys
 */
export class ProductCacheKeys {
  /**
   * ç”Ÿæˆå•†å“è¯¦æƒ…ç¼“å­˜é”®
   * @param id å•†å“ID
   * @returns ç¼“å­˜é”®
   */
  static productDetail(id: number): string {
    return `product:detail:${id}`;
  }
  
  /**
   * ç”Ÿæˆå•†å“åˆ—è¡¨ç¼“å­˜é”®
   * @param params æŸ¥è¯¢å‚æ•°
   * @returns ç¼“å­˜é”®
   */
  static productList(params: ProductQueryParams): string {
    const key = Object.keys(params)
      .sort()
      .map(k => `${k}=${params[k]}`)
      .join('&');
    return `product:list:${Buffer.from(key).toString('base64')}`;
  }
}
```

### è®¢å•æ¨¡å— (OrdersModule)

#### åŠŸèƒ½èŒè´£
- è®¢å•åˆ›å»ºå’Œå¤„ç†
- æ”¯ä»˜é›†æˆå’ŒéªŒè¯
- åº“å­˜æ‰£å‡å’Œæ¢å¤
- è®¢å•çŠ¶æ€è·Ÿè¸ª

#### äº‹åŠ¡å¤„ç†
```typescript
/**
 * è®¢å•åˆ›å»ºæœåŠ¡
 * 
 * å¤„ç†è®¢å•åˆ›å»ºçš„å®Œæ•´ä¸šåŠ¡æµç¨‹ï¼ŒåŒ…æ‹¬åº“å­˜éªŒè¯ã€ä»·æ ¼è®¡ç®—ã€
 * æ”¯ä»˜é¢„å¤„ç†ç­‰ï¼Œæ‰€æœ‰æ“ä½œåœ¨æ•°æ®åº“äº‹åŠ¡ä¸­æ‰§è¡Œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚
 * 
 * @class OrderCreationService
 * @Injectable
 */
@Injectable()
export class OrderCreationService {
  /**
   * åˆ›å»ºæ–°è®¢å•
   * 
   * è¯¥æ–¹æ³•æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
   * 1. å¼€å¯æ•°æ®åº“äº‹åŠ¡
   * 2. éªŒè¯å•†å“åº“å­˜
   * 3. è®¡ç®—è®¢å•æ€»ä»·
   * 4. åˆ›å»ºè®¢å•è®°å½•
   * 5. æ‰£å‡å•†å“åº“å­˜
   * 6. æäº¤äº‹åŠ¡æˆ–å›æ»š
   * 
   * @param orderData è®¢å•æ•°æ®
   * @returns åˆ›å»ºçš„è®¢å•
   */
  async createOrder(orderData: CreateOrderDto): Promise<Order> {
    // å®ç°ç»†èŠ‚
  }
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### æ•°æ®åº“ä¼˜åŒ–
```typescript
/**
 * æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å™¨
 * 
 * æä¾›é«˜æ•ˆçš„æ•°æ®åº“æŸ¥è¯¢æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š
 * - åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
 * - å…³è”æŸ¥è¯¢é¢„åŠ è½½
 * - æŸ¥è¯¢ç»“æœç¼“å­˜
 * - æ…¢æŸ¥è¯¢ç›‘æ§
 * 
 * @class QueryOptimizer
 */
export class QueryOptimizer {
  /**
   * ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢
   * 
   * ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µæ›¿ä»£åç§»åˆ†é¡µï¼Œæé«˜å¤§æ•°æ®é‡ä¸‹çš„æŸ¥è¯¢æ€§èƒ½ã€‚
   * 
   * @param queryBuilder æŸ¥è¯¢æ„å»ºå™¨
   * @param cursor æ¸¸æ ‡å€¼
   * @param limit æ¯é¡µæ•°é‡
   * @returns ä¼˜åŒ–åçš„æŸ¥è¯¢
   */
  optimizePagination(
    queryBuilder: SelectQueryBuilder<any>,
    cursor: string,
    limit: number
  ): SelectQueryBuilder<any> {
    // å®ç°ç»†èŠ‚
  }
}
```

### ç¼“å­˜ç­–ç•¥
```typescript
/**
 * å¤šçº§ç¼“å­˜ç®¡ç†å™¨
 * 
 * å®ç°å†…å­˜ç¼“å­˜ + Redisç¼“å­˜çš„äºŒçº§ç¼“å­˜ç­–ç•¥ï¼Œæä¾›ï¼š
 * - æœ¬åœ°å†…å­˜ç¼“å­˜ï¼ˆå¿«é€Ÿè®¿é—®ï¼‰
 * - Redisåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆæ•°æ®å…±äº«ï¼‰
 * - ç¼“å­˜ç©¿é€é˜²æŠ¤
 * - ç¼“å­˜é›ªå´©é˜²æŠ¤
 * 
 * @class MultiLevelCacheManager
 * @Injectable
 */
@Injectable()
export class MultiLevelCacheManager {
  /**
   * è·å–ç¼“å­˜æ•°æ®
   * 
   * ä¼˜å…ˆä»å†…å­˜ç¼“å­˜è·å–ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æŸ¥è¯¢Redisï¼Œ
   * å¦‚æœRedisä¹Ÿä¸å­˜åœ¨åˆ™æ‰§è¡Œå›è°ƒå‡½æ•°è·å–æ•°æ®å¹¶ç¼“å­˜ã€‚
   * 
   * @param key ç¼“å­˜é”®
   * @param callback æ•°æ®è·å–å›è°ƒ
   * @param ttl ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰
   * @returns ç¼“å­˜æ•°æ®
   */
  async get<T>(key: string, callback: () => Promise<T>, ttl: number): Promise<T> {
    // å®ç°ç»†èŠ‚
  }
}
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### è¾“å…¥éªŒè¯
```typescript
/**
 * å®‰å…¨è¾“å…¥éªŒè¯ç®¡é“
 * 
 * å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼éªŒè¯ï¼Œé˜²æ­¢SQLæ³¨å…¥ã€XSSæ”»å‡»ç­‰å®‰å…¨å¨èƒã€‚
 * 
 * @class ValidationPipe
 * @extends Built-in ValidationPipe
 */
export class SecureValidationPipe extends ValidationPipe {
  constructor() {
    super({
      whitelist: true,        // ç§»é™¤ä¸åœ¨DTOä¸­çš„å±æ€§
      forbidNonWhitelisted: true, // ç¦æ­¢æœªçŸ¥å±æ€§
      transform: true,        // è‡ªåŠ¨ç±»å‹è½¬æ¢
      forbidUnknownValues: true, // ç¦æ­¢æœªçŸ¥å€¼
    });
  }
}
```

### é€Ÿç‡é™åˆ¶
```typescript
/**
 * æ™ºèƒ½é€Ÿç‡é™åˆ¶å™¨
 * 
 * æ ¹æ®ç”¨æˆ·è¡Œä¸ºå’ŒIPåœ°å€å®æ–½åŠ¨æ€é€Ÿç‡é™åˆ¶ï¼Œé˜²æ­¢æ¶æ„è¯·æ±‚å’ŒDDoSæ”»å‡»ã€‚
 * 
 * @class SmartThrottlerGuard
 * @Injectable
 */
@Injectable()
export class SmartThrottlerGuard {
  /**
   * æ£€æŸ¥è¯·æ±‚é¢‘ç‡
   * 
   * æ ¹æ®ç”¨æˆ·IDã€IPåœ°å€å’Œæ¥å£ç±»å‹è®¡ç®—è¯·æ±‚é¢‘ç‡ï¼Œ
   * å¦‚æœè¶…è¿‡é˜ˆå€¼åˆ™æ‹’ç»è¯·æ±‚ã€‚
   * 
   * @param context æ‰§è¡Œä¸Šä¸‹æ–‡
   * @returns æ˜¯å¦å…è®¸è¯·æ±‚
   */
  async canActivate(context: ExecutionContext): Promise<boolean> {
    // å®ç°ç»†èŠ‚
  }
}
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ€§èƒ½ç›‘æ§
```typescript
/**
 * æ€§èƒ½ç›‘æ§ä¸­é—´ä»¶
 * 
 * è®°å½•æ¯ä¸ªAPIè¯·æ±‚çš„æ‰§è¡Œæ—¶é—´ã€å†…å­˜ä½¿ç”¨ç­‰æ€§èƒ½æŒ‡æ ‡ï¼Œ
 * å¹¶ä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿã€‚
 * 
 * @class PerformanceMiddleware
 * @Injectable
 */
@Injectable()
export class PerformanceMiddleware implements NestMiddleware {
  use(req: Request, res: Response, next: NextFunction) {
    const start = Date.now();
    
    res.on('finish', () => {
      const duration = Date.now() - start;
      const memoryUsage = process.memoryUsage();
      
      // è®°å½•æ€§èƒ½æŒ‡æ ‡
      this.metrics.recordApiCall({
        method: req.method,
        path: req.path,
        duration,
        memory: memoryUsage.heapUsed,
        statusCode: res.statusCode,
      });
    });
    
    next();
  }
}
```

### ç»“æ„åŒ–æ—¥å¿—
```typescript
/**
 * ç»“æ„åŒ–æ—¥å¿—æœåŠ¡
 * 
 * æä¾›ç»Ÿä¸€çš„æ—¥å¿—è®°å½•æ¥å£ï¼Œæ”¯æŒä¸åŒæ—¥å¿—çº§åˆ«å’Œç»“æ„åŒ–æ•°æ®è¾“å‡ºã€‚
 * 
 * @class StructuredLogger
 * @Injectable
 */
@Injectable()
export class StructuredLogger {
  /**
   * è®°å½•ä¸šåŠ¡æ—¥å¿—
   * 
   * @param level æ—¥å¿—çº§åˆ«
   * @param message æ—¥å¿—æ¶ˆæ¯
   * @param context æ—¥å¿—ä¸Šä¸‹æ–‡
   * @param metadata å…ƒæ•°æ®
   */
  log(level: LogLevel, message: string, context?: any, metadata?: any) {
    const logEntry = {
      timestamp: new Date().toISOString(),
      level,
      message,
      context,
      metadata,
      pid: process.pid,
    };
    
    // è¾“å‡ºåˆ°æ–‡ä»¶å’Œæ§åˆ¶å°
    console.log(JSON.stringify(logEntry));
  }
}
```

## ğŸ”„ éƒ¨ç½²å’Œè¿ç»´

### å¥åº·æ£€æŸ¥
```typescript
/**
 * ç»¼åˆå¥åº·æ£€æŸ¥æœåŠ¡
 * 
 * æ£€æŸ¥åº”ç”¨å„ä¸ªç»„ä»¶çš„å¥åº·çŠ¶æ€ï¼ŒåŒ…æ‹¬ï¼š
 * - æ•°æ®åº“è¿æ¥
 * - Redisè¿æ¥
 * - å¤–éƒ¨æœåŠ¡ä¾èµ–
 * - ç³»ç»Ÿèµ„æºä½¿ç”¨
 * 
 * @class HealthCheckService
 * @Injectable
 */
@Injectable()
export class HealthCheckService {
  /**
   * æ‰§è¡Œå¥åº·æ£€æŸ¥
   * 
   * @returns å¥åº·æ£€æŸ¥ç»“æœ
   */
  async check(): Promise<HealthCheckResult> {
    return {
      status: 'ok',
      timestamp: new Date().toISOString(),
      checks: {
        database: await this.checkDatabase(),
        redis: await this.checkRedis(),
        memory: this.checkMemory(),
        disk: this.checkDisk(),
      },
    };
  }
}
```

---

**æœ€åæ›´æ–°**: 2025-09-30  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0