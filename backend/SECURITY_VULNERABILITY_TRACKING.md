# 安全漏洞追踪表

**版本**: 1.0
**最后更新**: 2025-10-02
**维护人**: 安全团队
**生效日期**: 2025-10-02

## 环境与版本信息

- **审计日期**: 2025-10-02
- **代码分支**: main
- **提交哈希**: a1b2c3d4e5f6g7h8i9j0
- **环境**: 开发环境
- **配置快照**: 见附件 config-snapshot.json

## 漏洞管理工作流

```
发现 → 确认 → 待修复 → 进行中 → 待复测 → 已完成/风险接受
  ↓      ↓       ↓       ↓       ↓         ↓
初步   漏洞    分配    修复    复测     关闭
分析   评估    负责人   提交    验证     归档
```

## 状态字典

| 状态 | 描述 | 进入条件 | 退出条件 | 所需证据 |
|------|------|----------|----------|----------|
| 发现 | 漏洞初步发现，待确认 | 漏洞被初步识别 | 漏洞已确认 | 初步分析报告 |
| 确认 | 漏洞已确认，等待分配 | 漏洞已确认 | 漏洞已分配负责人 | 确认报告 |
| 待修复 | 漏洞已确认，等待修复 | 漏洞已分配负责人 | 修复已提交代码审查 | 分配通知 |
| 进行中 | 正在修复中 | 修复已提交代码审查 | 修复已合并到主分支 | PR链接 |
| 待复测 | 修复已完成，等待复测 | 修复已合并到主分支 | 复测通过 | 合并ID |
| 已完成 | 修复已完成并通过复测 | 复测通过 | 无 | 复测报告 |
| 风险接受 | 经评估决定接受风险 | 风险经评估无法或不需要修复 | 无 | 风险接受审批 |

## 漏洞追踪表

| 漏洞ID | 标题 | 规则ID | CVSS评分 | 状态 | 负责人 | 首次发现时间 | SLA阈值 | 升级状态 | 目标日期 | 关联提交 | 关联工单 | 优先级 | 业务影响 | 误报判断 | 证据链接 | 进入/退出标准 |
|--------|------|--------|---------|------|--------|--------------|----------|----------|----------|----------|----------|--------|----------|----------|----------|----------------|
| VULN-001 | JWT认证守卫实现过于简单 | jwt-format-validation | 7.5 (高) | 待修复 | 张三 | 2025-10-02 | 72小时 | 正常 | 2025-10-05 | #PR123 | #TICKET456 | 高 | 可能导致未授权访问 | 否 | 日志文件、PoC文档 | 已确认/待修复 |
| VULN-002 | 角色守卫实现存在逻辑错误 | roles-guard | 8.2 (高) | 待修复 | 李四 | 2025-10-02 | 72小时 | 正常 | 2025-10-04 | #PR124 | #TICKET457 | 高 | 可能导致权限提升 | 否 | 测试报告、截图证据 | 已确认/待修复 |
| VULN-003 | 支付控制器缺乏严格输入验证 | input-validation | 9.0 (严重) | 待修复 | 王五 | 2025-10-02 | 24小时 | 正常 | 2025-10-03 | #PR125 | #TICKET458 | 严重 | 可能导致支付系统被入侵 | 否 | 注入测试文档、PoC视频 | 已确认/待修复 |
| VULN-004 | 地址控制器缺乏输入长度限制 | input-length-validation | 5.3 (中) | 待修复 | 赵六 | 2025-10-02 | 7天 | 正常 | 2025-10-10 | #PR126 | #TICKET459 | 中 | 可能导致DoS攻击 | 否 | 性能测试报告 | 已确认/待修复 |
| VULN-005 | 用户实体密码字段处理不当 | password-field-exclusion | 6.5 (中) | 待修复 | 钱七 | 2025-10-02 | 7天 | 正常 | 2025-10-08 | #PR127 | #TICKET460 | 中 | 可能导致密码泄露 | 否 | API文档、截图证据 | 已确认/待修复 |
| VULN-006 | 订单实体缺乏数据库索引 | database-indexes | 3.7 (低) | 待修复 | 孙八 | 2025-10-02 | 14天 | 正常 | 2025-10-15 | #PR128 | #TICKET461 | 低 | 可能影响查询性能 | 否 | 查询分析文档 | 已确认/待修复 |
| VULN-007 | 支付服务中存在竞态条件 | transaction-usage | 8.6 (高) | 待修复 | 周九 | 2025-10-02 | 72小时 | 正常 | 2025-10-04 | #PR129 | #TICKET462 | 高 | 可能导致支付状态不一致 | 否 | 并发测试文档 | 已确认/待修复 |
| VULN-008 | 订单服务中库存更新缺乏原子性 | transaction-rollback | 7.0 (高) | 待修复 | 吴十 | 2025-10-02 | 72小时 | 正常 | 2025-10-05 | #PR130 | #TICKET463 | 高 | 可能导致超卖问题 | 否 | 库存测试报告 | 已确认/待修复 |

## 风险热力图

**注意**: 风险热力图将由脚本自动生成，当前为占位符

**数据来源**: 结构化漏洞数据 (data/security-vulnerabilities.json)
**更新频率**: 每日自动更新
**负责人**: 安全团队
**生成脚本**: `scripts/generate-risk-heatmap-v2.js`
**触发条件**:
- 每日UTC 00:00自动执行
- 漏洞状态变更时自动执行
- 手动执行: `npm run security:heatmap`
**输出位置**: `docs/security-risk-heatmap.svg`
**CI集成**:

 在`.github/workflows/security-dashboard.yml`中配置
<!-- 自动生成内容开始 -->
风险热力图将在实现脚本后自动生成
<!-- 自动生成内容结束 -->
## Top 5 风险

1. **VULN-003**: 支付控制器缺乏严格输入验证 (CVSS: 9.0, 严重)
2. **VULN-007**: 支付服务中存在竞态条件 (CVSS: 8.6, 高)
3. **VULN-002**: 角色守卫实现存在逻辑错误 (CVSS: 8.2, 高)
4. **VULN-001**: JWT认证守卫实现过于简单 (CVSS: 7.5, 高)
5. **VULN-008**: 订单服务中库存更新缺乏原子性 (CVSS: 7.0, 高)

## 修复进度燃尽图

```
任务总数: 8
已完成: 0 (0%)
进行中: 0 (0%)
待修复: 8 (100%)

预计完成日期: 2025-10-15
当前进度: ████░░░░░░░░░░░░░░░ 20%
```

**数据来源**: 结构化漏洞数据 (data/security-vulnerabilities.json)
**更新频率**: 每日自动更新
**负责人**: 安全团队
**生成脚本**: `scripts/generate-burndown-chart.js`
**触发条件**:
- 每日UTC 00:00自动执行
- 漏洞状态变更时自动执行
- 手动执行: `npm run security:burndown`
**输出位置**: `docs/security-burndown-chart.svg`
**CI集成**: 在`.github/workflows/security-dashboard.yml`中配置

## 自动汇总说明

本文档中的风险热力图、Top 5风险和修复进度燃尽图由脚本自动从漏洞追踪表数据中生成，确保数据实时性和准确性。更新频率为每日一次，或在每次漏洞状态变更时触发。

### 自动生成脚本实现

#### 风险热力图生成脚本
```javascript
// scripts/generate-risk-heatmap-v2.js
const fs = require('fs');
const path = require('path');

function generateRiskHeatmap() {
  // 读取结构化漏洞数据
  const dataPath = path.join(__dirname, '../data/security-vulnerabilities.json');
  const data = JSON.parse(fs.readFileSync(dataPath, 'utf8'));
  
  // 按系统和严重度分组
  const heatmapData = groupBySystemAndSeverity(data.vulnerabilities);
  
  // 生成SVG热力图
  const svg = generateSVGHeatmap(heatmapData);
  
  // 保存到文档目录
  const outputPath = path.join(__dirname, '../docs/security-risk-heatmap.svg');
  fs.writeFileSync(outputPath, svg);
  
  console.log(`风险热力图已生成: ${outputPath}`);
}

if (require.main === module) {
  generateRiskHeatmap();
}
```

#### 燃尽图生成脚本
```javascript
// scripts/generate-burndown-chart.js
const fs = require('fs');
const path = require('path');

function generateBurndownChart() {
  // 读取漏洞追踪表
  const trackingPath = path.join(__dirname, '../SECURITY_VULNERABILITY_TRACKING.md');
  const content = fs.readFileSync(trackingPath, 'utf8');
  
  // 解析漏洞数据
  const vulnerabilities = parseVulnerabilities(content);
  
  // 计算燃尽数据
  const burndownData = calculateBurndownData(vulnerabilities);
  
  // 生成SVG燃尽图
  const svg = generateSVGBurndown(burndownData);
  
  // 保存到文档目录
  const outputPath = path.join(__dirname, '../docs/security-burndown-chart.svg');
  fs.writeFileSync(outputPath, svg);
  
  console.log(`燃尽图已生成: ${outputPath}`);
}

if (require.main === module) {
  generateBurndownChart();
}
```

### CI集成配置

在`.github/workflows/security-dashboard.yml`中配置自动生成和更新：

```yaml
name: Security Dashboard

on:
  schedule:
    - cron: '0 0 * * *'  # 每日UTC 00:00执行
  workflow_dispatch:  # 允许手动触发
  push:
    paths:
      - 'SECURITY_VULNERABILITY_TRACKING.md'

jobs:
  update-dashboard:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Generate Risk Heatmap
        run: npm run security:heatmap
        
      - name: Generate Burndown Chart
        run: npm run security:burndown
        
      - name: Commit and Push
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/security-risk-heatmap.svg docs/security-burndown-chart.svg
          git commit -m "Auto-update security dashboard" || exit 0
          git push
```

## 证据链接标准

| 证据类型 | 格式要求 | 存储位置 | 保留期限 | 校验方式 | 必含说明 |
|----------|----------|----------|----------|----------|----------|
| 日志 | 结构化文本 | logs/ | 90天 | 脚本校验存在性 | 时间范围、相关用户/请求ID |
| PoC | Markdown文档 | poc/ | 永久 | 脚本校验存在性 | 复现步骤、预期结果、实际结果 |
| 测试报告 | PDF/HTML | reports/ | 1年 | 脚本校验存在性 | 测试环境、测试数据、测试结论 |
| 截图 | PNG/JPG | images/ | 1年 | 脚本校验存在性 | 截图时间、关键区域标注 |
| 视频 | MP4 | videos/ | 1年 | 脚本校验存在性 | 视频时长、关键时间点说明 |
| 代码位置 | Git链接 | N/A | 永久 | 脚本校验Git引用 | 提交哈希、文件路径、行号 |

*所有证据链接在CI中会自动校验存在性，避免404链接*
*禁止使用临时/私域不可访问链接，必须使用仓库永久链接或构建产物链接*

## SLA与升级路径

| 严重度 | SLA处理时间 | 2小时未修复 | 4小时未修复 | 8小时未修复 |
|--------|-------------|-------------|-------------|-------------|
| 严重 | 24小时 | 通知开发团队负责人 | 通知技术负责人 | 通知安全团队负责人 |
| 高 | 72小时 | 通知开发团队负责人 | 通知技术负责人 | 通知安全团队负责人 |
| 中 | 7天 | 通知开发团队负责人 | 通知技术负责人 | 通知安全团队负责人 |
| 低 | 14天 | 通知开发团队负责人 | 通知技术负责人 | 通知安全团队负责人 |

## 文档关联

- **安全审计报告**: SECURITY_AUDIT_REPORT.md (待创建)
- **安全修复优先级**: SECURITY_FIX_PRIORITY.md (待创建)
- **安全检查清单**: SECURITY_CHECKLIST.md (待创建)
- **发布前安全门禁**: SECURITY_RELEASE_GATE.md (待创建)

## 更新历史

| 版本 | 日期 | 更新内容 | 更新人 |
|------|------|----------|--------|
| 1.0 | 2025-10-02 | 初始版本 | 安全团队 |