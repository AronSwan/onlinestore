# 数据库配置
DATABASE_HOST=localhost
DATABASE_PORT=3306
DATABASE_USERNAME=root
DATABASE_PASSWORD=password
DATABASE_NAME=shopping_site
DATABASE_SYNCHRONIZE=false
DATABASE_LOGGING=true

# Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# 购物车 Redis 配置
CART_REDIS_DB=1
CART_CACHE_REDIS_DB=2
CART_CACHE_TTL=3600
CART_LOCK_TIMEOUT=30000
CART_LOCK_RETRY_DELAY=100
CART_LOCK_RETRY_COUNT=10

# JWT 配置
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=7d

# 增强的JWT安全配置
JWT_MIN_SECRET_LENGTH=32
JWT_ALGORITHM=RS256
JWT_ISSUER=caddy-shopping-api
JWT_AUDIENCE=caddy-shopping-client
JWT_KEY_SIZE=2048
JWT_KEY_FORMAT=pkcs8
JWT_PUBLIC_KEY_FORMAT=spki
JWT_TOKEN_EXPIRY=1h
JWT_REFRESH_TOKEN_EXPIRY=7d

# 应用配置
NODE_ENV=development
PORT=3000
API_PREFIX=api

# 日志配置
LOG_LEVEL=debug
LOG_FILE_PATH=./logs

# 分片配置（如果使用 ShardingSphere）
SHARDING_ENABLED=false
SHARDING_DATABASES=2
SHARDING_TABLES=4

# 监控配置
METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true

# 缓存配置
CACHE_TTL=300
CACHE_MAX_ITEMS=1000

# 文件上传配置
UPLOAD_DEST=./uploads
MAX_FILE_SIZE=10485760

# CORS 配置
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# 支付安全配置
PAYMENT_MAX_AMOUNT=1000000
PAYMENT_MAX_RETRY_COUNT=3
PAYMENT_CALLBACK_TIMEOUT_MINUTES=15
PAYMENT_NONCE_EXPIRY_MINUTES=15
PAYMENT_RATE_LIMIT_CREATE_TTL=60
PAYMENT_RATE_LIMIT_CREATE_LIMIT=10
PAYMENT_RATE_LIMIT_CALLBACK_TTL=60
PAYMENT_RATE_LIMIT_CALLBACK_LIMIT=100
PAYMENT_RATE_LIMIT_QUERY_TTL=60
PAYMENT_RATE_LIMIT_QUERY_LIMIT=60

# 加密配置
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY_LENGTH=32
ENCRYPTION_IV_LENGTH=12
ENCRYPTION_TAG_LENGTH=16

# 日志掩码配置
LOG_MASK_SENSITIVE_FIELDS=password,secret,token,key,signature,cardNumber,cvv,pin,privateKey,apiKey,accessToken,refreshToken
LOG_MASK_CHAR=*
LOG_MASK_VISIBLE_CHARS=4

# 请求验证配置
REQUEST_MAX_PAYLOAD_SIZE=10mb
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
CSRF_COOKIE_NAME=csrf-token

# 安全检查配置
SECURITY_CHECK_ENABLED=true
SECURITY_CHECK_FAIL_ON_HIGH=true
SECURITY_CHECK_SCAN_TIMEOUT=300000
SECURITY_CHECK_CACHE_ENABLED=true
SECURITY_CHECK_CACHE_DIR=.security-cache

# 安全监控配置
SECURITY_MONITORING_ENABLED=true
SECURITY_ALERT_THRESHOLD=5
SECURITY_LOG_RETENTION_DAYS=30